<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8"/>
  <meta name="author" content="Paul Slaymaker">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Trochoid demo by Paul Slaymaker</title>
  <style type="text/css">
    * { box-sizing:border-box; }
    tr.phead { background:#FAFAFF; border-bottom:1px solid silver; }
    div.pmain { background:#EFEFF8; border-bottom:1px solid silver; padding:4px 8px; text-align:left; white-space:nowrap; cursor:pointer; font-size:0.9em; }
    div.pmenu { background:#EFEFF8; border-bottom:1px solid silver; padding:4px 8px; text-align:left; white-space:nowrap; cursor:pointer; font-size:0.9em; }
    span.indic { float:right; transform:rotate(0deg); color:#888; }
    table.ctable { width:350px; margin:auto; border-bottom:1px solid silver; border-collapse:collapse; background:#FFF; }
    td.tlabel { text-align:right; padding:4px 8px; white-space:nowrap; }
    td.control { text-align:left; white-space:nowrap; }
    div.treport { float:left; width:40px; margin-top:4px; text-align:right; border:1px solid silver; padding-right:2px; }
    input.sliderR { width:100px; margin-left:8px; }
    input.sliderP { float:left; width:100px; margin-left:8px; }
    div.slabelLeft { float:left; width:40px; margin-top:4px; text-align:right; display:inline-block; }
    div.slabelRight { float:left; margin-top:4px; margin-left:6px; display:inline-block; }
    div.tacont { overflow:hidden; width:180px; height:0; }
    tr.c2show { display:table-row; }
    tr.c2hide { display:none; }
  </style>
</head>
<body style="font-family:sans-serif; font-size:0.8em; background:#F4F4F4;">
  <div style="display:table;">
    <div id="ascell" style="display:table-cell; width:100%; text-align:center;">
      <svg id="asvg" viewbox="0,0,400,400" style="margin-left:1px; height:auto;">
	<rect id="asbox" width="400px" height="400px" fill="#FFF" stroke="silver"/>
	<line x1="0" y1="200" x2="400" y2="200" stroke="silver" stroke-width=".5"/>
	<line x1="200" y1="0" x2="200" y2="400" stroke="silver" stroke-width=".5"/>
	<g transform="translate(200,200) rotate(-90)">
	  <path id="rpath" style="stroke:navy; stroke-width:.3; fill-opacity:1; fill-rule:evenodd;" d=""/>
	</g>
      </svg>
      <div id="abtn" style="text-align:center; padding:4px;">
	<button onclick="start();">start</button>
	<button onclick="step();">step</button>
	<button onclick="stop();">stop</button>
      </div>
    </div>
    <div style="display:table-cell; vertical-align:top; padding-left:16px;">
    </div>
    <div style="display:table-cell; vertical-align:top; text-align:center;">

      <div style="border:1px solid silver;">

        <div id="mainmenu" class="pmain" data-state="0" title="show" onclick="togAll(this)">
          <span class="indic">&#10148;</span>
          All properties
        </div>
        <div class="pmenu" data-state="0" title="show" data-con="curv" onclick="togMenu(this)">
          <span class="indic">&#10148;</span>
          Curve properties
        </div>
        <div id="cdivcurv" class="tacont">
	  <table id="propscurv" class="ctable" cellspacing="0">
	    <tr class="phead">
	      <td colspan="2">Curve one </td><td style="white-space:nowrap;">Keep value</td>
	    </tr>
	    <tr>
	     <td style="padding:4px; width:40%;"></td>
	     <td style="padding:4px; width:40%;"></td>
	     <td style="padding:4px; width:20%;"></td>
	    </tr>
	    <tr>
	      <td class="tlabel">Type:</td>
	      <td class="control">
		<select id="curveSel0" style="border:1px solid silver;" onchange="changeCurve(this,0)">
		 <option>epitrochoid</option>
		 <option>epiepitrochoid</option>
		 <option>hypoepitrochoid</option>
		 <option>hypotrochoid</option>
		 <option>epihypotrochoid</option>
		 <option>hypohypotrochoid</option>
		</select>
	      </td>
	      <td><input id="kCurve0" type="checkbox" onclick="keepCurve(this,0);"/></td>
	    </tr>
	    <tr>
	      <td class="tlabel">First radius:</td>
	      <td class="control">
		<div id="rad1-0" class="treport">&#160;</div>
		<input id="rad1Sel0" type="range" class="sliderR" min="0" max="120" step="0.1" oninput="changeR1(this,0);"></input>
	      </td>
	      <td><input id="kR0-0" type="checkbox" onclick="keepR1(this,0);"/></td>
	    </tr>
	    <tr>
	      <td class="tlabel">Second radius:</td>
	      <td class="control">
		<div id="rad2-0" class="treport">&#160;</div>
		<input id="rad2Sel0" type="range" class="sliderR" min="0" max="120" step="0.1" oninput="changeR2(this,0);"></input>
	      </td>
	      <td><input id="kR1-0" type="checkbox" onclick="keepR2(this,0);"/></td>
	    </tr>
	    <tr>
	      <td class="tlabel">Third radius:</td>
	      <td class="control">
		<div id="rad3-0" class="treport">&#160;</div>
		<input id="rad3Sel0" type="range" class="sliderR" min="0" max="120" step="0.1" oninput="changeR3(this,0);"></input>
	      </td>
	      <td><input id="kR3-0" type="checkbox" onclick="keepR3(this,0);"/></td>
	    </tr>
	    <tr>
	      <td class="tlabel">Primary cycles:</div>
	      <td class="control">
		<div id="c0-0" class="treport">&#160;</div>
		<input id="c0Sel0" type="range" class="sliderR" min="1" max="15" step="1" oninput="changeC0(this,0)"></input>
	      </td>
	      <td><input id="kC0-0" type="checkbox" onclick="keepC0(this,0);"/></td>
	    </tr>
	    <tr>
	      <td class="tlabel">Secondary cycles:</div>
	      <td class="control">
		<div id="c1-0" class="treport">&#160;</div>
		<input id="c1Sel0" type="range" class="sliderR" min="1" max="15" step="1" oninput="changeC1(this,0)"></input>
	      </td>
	      <td><input id="kC1-0" type="checkbox" onclick="keepC1(this,0);"/></td>
	    </tr>
	    <tr>
	      <td class="tlabel">Tertiary cycles:</td>
	      <td class="control">
		<div id="c2-0" class="treport">&#160;</div>
		<input id="c2Sel0" type="range" class="sliderR" min="1" max="15" step="1" oninput="changeC2(this,0)"></input>
	      </td>
	      <td><input id="kC2-0" type="checkbox" onclick="keepC2(this,0);"/></td>
	    </tr>
	    <tr><td colspan="3" style="padding:4px;"></td></tr>
	    <tr class="phead" style="border-top:1px solid silver;">
	      <td colspan="3" style="text-align:left;">
                <button id="c2btn" style="float:left; font-size:.7em; padding:0; margin:1px 56px 0px 10px; opacity:.6; width:44px; border:1px outset #D8D8D8;" onclick="switchCurveTwo()">remove</button>
                Curve two
              </td>
  <!--
	      <td>Keep value</td>
  -->
	    </tr>
	    <tr class="c2show"><td colspan="3" style="padding:4px;"></td></tr>
	    <tr class="c2show" style="height:0px;">
	      <td class="tlabel">Type:</td>
	      <td class="control">
		<select id="curveSel1" style="border:1px solid silver;" onchange="changeCurve(this,1)">
		 <option>epitrochoid</option>
		 <option>epiepitrochoid</option>
		 <option>hypoepitrochoid</option>
		 <option>hypotrochoid</option>
		 <option>epihypotrochoid</option>
		 <option>hypohypotrochoid</option>
		</select>
	      </td>
	      <td><input id="kCurve1" type="checkbox" onclick="keepCurve(this,1);"/></td>
	    </tr>
	    <tr class="c2show">
	      <td class="tlabel">First radius:</td>
	      <td class="control">
		<div id="rad1-1" class="treport">&#160;</div>
		<input id="rad1Sel1" type="range" class="sliderR" min="0" max="120" step="0.1" oninput="changeR1(this,1);"></input>
	      </td>
	      <td><input id="kR0-1" type="checkbox" onclick="keepR1(this,1);"/></td>
	    </tr>
	    <tr class="c2show">
	      <td class="tlabel">Second radius:</td>
	      <td class="control">
		<div id="rad2-1" class="treport">&#160;</div>
		<input id="rad2Sel1" type="range" class="sliderR" min="0" max="120" step="0.1" oninput="changeR2(this,1);"></input>
	      </td>
	      <td><input id="kR1-1" type="checkbox" onclick="keepR2(this,1);"/></td>
	    </tr>
	    <tr class="c2show">
	      <td class="tlabel">Third radius:</td>
	      <td class="control">
		<div id="rad3-1" class="treport">&#160;</div>
		<input id="rad3Sel1" type="range" class="sliderR" min="0" max="120" step="0.1" oninput="changeR3(this,1);"></input>
	      </td>
	      <td><input id="kR3-1" type="checkbox" onclick="keepR3(this,1);"/></td>
	    </tr>
	    <tr class="c2show">
	      <td class="tlabel">Primary cycles:</div>
	      <td class="control">
		<div id="c0-1" class="treport">&#160;</div>
		<input id="c0Sel1" type="range" class="sliderR" min="1" max="15" step="1" oninput="changeC0(this,1)"></input>
	      </td>
	      <td><input id="kC0-1" type="checkbox" onclick="keepC0(this,1);"/></td>
	    </tr>
	    <tr class="c2show">
	      <td class="tlabel">Secondary cycles:</div>
	      <td class="control">
		<div id="c1-1" class="treport">&#160;</div>
		<input id="c1Sel1" type="range" class="sliderR" min="1" max="15" step="1" oninput="changeC1(this,1)"></input>
	      </td>
	      <td><input id="kC1-1" type="checkbox" onclick="keepC1(this,1);"/></td>
	    </tr>
	    <tr class="c2show">
	      <td class="tlabel">Tertiary cycles:</td>
	      <td class="control">
		<div id="c2-1" class="treport">&#160;</div>
		<input id="c2Sel1" type="range" class="sliderR" min="1" max="15" step="1" oninput="changeC2(this,1)"></input>
	      </td>
	      <td><input id="kC2-1" type="checkbox" onclick="keepC2(this,1);"/></td>
	    </tr>
	    <tr class="c2show"><td colspan="3" style="padding:4px;"></td></tr>
	  </table>
        </div>
        <div class="pmenu" data-state="0" title="show" data-con="anim" onclick="togMenu(this)">
          <span class="indic">&#10148;</span>
          Animation properties
        </div>
        <div id="cdivanim" class="tacont">
	  <table id="propsanim" cellspacing="0" class="ctable">
	    <tr>
	     <td style="padding:4px;"></td>
	     <td style="padding:4px;"></td>
	    </tr>
   
	    <tr>
	      <td class="tlabel">Transition speed:</td>
	      <td class="control">
		<div class="slabelLeft">slow</div>
		<input type="range" class="sliderP" min="1" max="10" value="4" onchange="changeSpeed(this);"></input>
		<div class="slabelRight">fast</div>
	      </td>
	    </tr>
	    <tr>
	      <td class="tlabel">Symmetry:</td>
	      <td class="control">
		<div class="slabelLeft">less</div>
		<input type="range" class="sliderP" min="0" max="3" step="1" value="3" onchange="changeSymmetry(this);"></input>
		<div class="slabelRight">more</div>
	      </td>
	    </tr>
	    <tr>
	      <td class="tlabel">Rotation effect:</td>
	      <td class="control">
		<div class="slabelLeft">none</div>
		<input type="range" class="sliderP" min="0" max="4" step="0.1" onchange="changeRotation(this);"></input>
		<div class="slabelRight">full</div>
	      </td>
	    </tr>
	    <tr>
	      <td class="tlabel">Pause after transition:</td>
	      <td class="control">
		<div class="slabelLeft">none</div>
		<input type="range" class="sliderP" min="0" max="5" step="0.1" value="0" onchange="changePause(this);"></input>
		<div class="slabelRight">5 secs</div>
	      </td>
	    </tr>
	    <tr>
	      <td class="tlabel">Damp curve changes:</td>
	      <td class="control">
		<div class="slabelLeft">full</div>
		<input type="range" class="sliderP" min="0.1" max="1" step=".01" value="0.15" onchange="changeDamp(this);"></input>
		<div class="slabelRight">none</div>
	      </td>
	    </tr>
	    <tr><td colspan="2" style="padding:4px;"></td></tr>
	  </table>
        </div>
        <div class="pmenu" style="min-width:180px;" data-state="0" data-con="pres" title="show" onclick="togMenu(this)">
          <span class="indic">&#10148;</span>
          <div>Presentation properties</div>
        </div>
        <div id="cdivpres" class="tacont">
	  <table id="propspres" cellspacing="0" class="ctable">
	    <tr><td colspan="3" style="padding:4px;"></td></tr>
	    <tr>
	      <td class="tlabel">Fill:</td>
	      <td colspan="2" class="control" style="padding-right:8px;">
		<label><input id="nofill" type="radio" name="fcolor" onclick="changeFill(this);"></input>none</label>
		&#160;
		<label><input id="ranfill" type="radio" name="fcolor" checked="checked" onclick="changeFill(this);"></input>random</label>
		&#160;
		<input id="colfill" type="radio" name="fcolor" onclick="changeFill(this);">color</input>
		<input id="colorSel" type="color" style="width:22px; height:16px; padding:0;" oninput="changeFillColor(this);"></input>
	      </td>
	    </tr>
	    <tr>
	      <td class="tlabel">Line width:</td>
	      <td colspan="2" class="control">
		<div class="slabelLeft">none</div>
		<input type="range" class="sliderP" min="0" max="5" step=".1" value=".3" oninput="changeLineWidth(this);"></input>
		<div class="slabelRight">full</div>
	      </td>
	    </tr>
	    <tr>
	      <td class="tlabel">Line color:</td>
	      <td colspan="2" class="control">
		<input id="colorSel" type="color" style="width:22px; height:16px; padding:0;" value="#000080" oninput="changeLineColor(this);"></input>
	      </td>
	    </tr>
	    <tr>
	      <td class="tlabel">Background color:</td>
	      <td colspan="2" class="control">
		<input id="colorSel" type="color" style="width:22px; height:16px; padding:0;" value="#FFFFFF" oninput="changeBackground(this);"></input>
	      </td>
	    </tr>
	    <tr><td colspan="3" style="padding:4px;"></td></tr>
	  </table>
        </div>
        <div class="pmain">
          <a href="http://paulslaymaker.no-ip.org/as/q.html" style="text-decoration:none; color:black; display:block;" target="_blank">Questions?</a>
        </div>

      </div>

    </div>

    </div>

  <script type="text/javascript">
<!--
onresize = new function() {
  var a = document.getElementById("abtn").offsetHeight;
  document.getElementById("asvg").style.maxHeight = window.innerHeight - a - 20 + "px";
};
function getRandomInt(a, b) {
  a = Math.ceil(a);
  b = Math.floor(b);
  return Math.floor(Math.random() * (b - a)) + a;
}
function getLowRandomInt(a, b) {
  a = Math.ceil(a);
  b = Math.floor(b);
  return Math.floor(Math.random() * Math.random() * (b - a)) + a;
}
function randomColor(a) {
  for (var b = "#", d = 0; 3 > d; d++) {
    var e = a ? getRandomInt(60, 240).toString(16) : getRandomInt(120, 240).toString(16);
    b += e;
  }
  return b;
}
function getZeroCurve() {
  for (var a = "M0 0", b = .01; b < 2 * Math.PI; b += .01) {
    a += "L0 0";
  }
  return a + "z";
}
var path = document.getElementById("rpath"), a2 = document.createElementNS("http://www.w3.org/2000/svg", "animate");
a2.setAttribute("attributeName", "d");
a2.setAttribute("to", "");
a2.setAttribute("to", getZeroCurve() + " " + getZeroCurve());
a2.setAttribute("fill", "freeze");
a2.setAttribute("begin", "indefinate");
a2.setAttribute("restart", "whenNotActive");
a2.setAttribute("calcMode", "spline");
a2.setAttribute("keyTimes", "0;1");
a2.setAttribute("keySplines", ".4 0 .6 1");
path.appendChild(a2);
var acol = document.createElementNS("http://www.w3.org/2000/svg", "animate");
acol.setAttribute("attributeName", "fill");
acol.setAttribute("to", "white");
acol.setAttribute("from", "white");
acol.setAttribute("fill", "freeze");
path.appendChild(acol);
var ET = "epitrochoid", HT = "hypotrochoid", EET = "epiepitrochoid", HET = "hypoepitrochoid", EHT = "epihypotrochoid", HHT = "hypohypotrochoid", curves = [{type:ET, c1:3, c2:3, reset:!0}, {type:HT, c1:3, c2:3, reset:!0}], durationFactor = 1, rotationFactor = 1, pause = 0, transition, color = "random", symmetry = 3, curveChangeRate = .15, ONE = 0, TWO = 1, curveCount = TWO;
function getMatchingCycle(a) {
  switch(a) {
    case 2:
      return 2 * getRandomInt(1, 7);
    case 3:
      return 3 * getRandomInt(1, 5);
    case 4:
    case 8:
    case 12:
      return 2 > symmetry ? 2 * getRandomInt(1, 7) : 4 * getRandomInt(1, 4);
    case 5:
    case 10:
    case 15:
      return 5 * getRandomInt(1, 4);
    case 7:
      return 7 * getRandomInt(1, 3);
    case 9:
      return 3 > symmetry ? 3 * getRandomInt(1, 4) : 9;
    default:
      return a;
  }
}
function setCycles(a) {
  var b = curves[a], d = ET == b.type || HT == b.type;
  [2, 3, 5].forEach(function(a) {
    if (d) {
      for (; 0 == b.c0 % a && 0 == b.c1 % a;) {
        b.c0 /= a, b.c1 /= a;
      }
    } else {
      for (; 0 == b.c0 % a && 0 == b.c1 % a && 0 == b.c2 % a;) {
        b.c0 /= a, b.c1 /= a, b.c2 /= a;
      }
    }
  });
}
function randomizeRadii() {
  [[0], [0, 1]][curveCount].forEach(function(a) {
    curves[a].type == ET || curves[a].type == HT ? (void 0 == curves[a].r1Keep && (curves[a].r1 = 45 + 90 * Math.random()), void 0 == curves[a].drawKeep && (curves[a].r2 = 45 + 90 * Math.random())) : (void 0 == curves[a].r1Keep && (curves[a].r1 = 30 + 60 * Math.random()), void 0 == curves[a].drawKeep && (curves[a].r2 = 30 + 60 * Math.random()), void 0 == curves[a].r3Keep && (curves[a].r3 = 30 + 60 * Math.random()));
  });
}
function reduceable2(a) {
  var b = curves[a];
  return [2, 3, 5, 7, 11, 13].some(function(a) {
    return 0 == b.c0 % a && 0 == b.c1 % a;
  });
}
function reduceable3(a) {
  var b = curves[a];
  return [2, 3, 5, 7, 11, 13].some(function(a) {
    return 0 == b.c0 % a && 0 == b.c1 % a && 0 == b.c2 % a;
  });
}
function getLowC1() {
  switch(symmetry) {
    case 1:
      return 2;
    case 3:
      return 4;
  }
  return 3;
}
function randomizeSym1Curve() {
  if (Math.random() < curveChangeRate) {
    void 0 == curves[0].curveKeep && getRandomCurve(0);
    void 0 == curves[0].c0Keep && (curves[0].c0 = getLowRandomInt(1, 16));
    var a = getLowC1();
    if (curves[0].type == ET || curves[0].type == HT) {
      do {
        curves[0].c1 = getRandomInt(a, 16);
      } while (curves[0].c1 == curves[0].c0 || reduceable2(0));
    } else {
      do {
        curves[0].c1 = getRandomInt(a, 16), curves[0].c2 = getMatchingCycle(curves[0].c1);
      } while (curves[0].c1 == curves[0].c0 || reduceable3(0));
    }
  }
  randomizeRadii();
}
function get22Set() {
  var a = getLowC1();
  do {
    do {
      curves[0].c1 = getRandomInt(a, 16), curves[1].c1 = curves[0].c1;
    } while (curves[0].c1 == curves[0].c0 || curves[0].c1 == curves[1].c0);
  } while (reduceable2(0) || reduceable2(1));
}
function get23Set(a) {
  var b = 1 == a ? 0 : 1, d = getLowC1();
  do {
    curves[1].c0 = getRandomInt(1, 16), curves[0].c1 = getRandomInt(d, 16), curves[1].c1 = getMatchingCycle(curves[0].c1), curves[a].c2 = getMatchingCycle(curves[0].c1);
  } while (reduceable2(b) || reduceable3(a));
}
function get33Set() {
  var a = getLowC1();
  do {
    curves[1].c0 = getRandomInt(1, 16), curves[0].c1 = getRandomInt(a, 16), curves[1].c1 = getMatchingCycle(curves[0].c1), curves[0].c2 = getMatchingCycle(curves[0].c1), curves[1].c2 = getMatchingCycle(curves[0].c1);
  } while (reduceable3(0) || reduceable3(1));
}
function getPreferredRandomCurve(a) {
  var b = Math.random();
  a.type = .10 > b ? EET : .24 > b ? HET : .38 > b ? ET : .57 > b ? EHT : .76 > b ? HT : HHT;
}
function getRandomCurve(a) {
  curves[a].type = [ET, EET, HET, HT, EHT, HHT][getRandomInt(0, 6)];
}
function randomizeSym2Curves() {
  var a = !1, b = Math.random() < curveChangeRate;
  curves.forEach(function(d) {
    if (b || d.reset) {
      void 0 == d.curveKeep && getPreferredRandomCurve(d), void 0 == d.c0Keep && (d.c0 = getLowRandomInt(1, 16)), a = !0;
    }
    d.reset = !1;
  });
  a && [0, 1].forEach(function(a) {
    curves[0].type == ET || curves[0].type == HT ? curves[1].type == ET || curves[1].type == HT ? get22Set() : get23Set(1) : curves[1].type == ET || curves[1].type == HT ? get23Set(0) : get33Set();
  });
  randomizeRadii();
}
function randomizeCurves() {
  [[0], [0, 1]][curveCount].forEach(function(a) {
    if (curves[a].reset || Math.random() < curveChangeRate) {
      void 0 == curves[a].curveKeep && getRandomCurve(a), void 0 == curves[a].c0Keep && (curves[a].c0 = getRandomInt(1, 16)), void 0 == curves[a].c1Keep && (curves[a].c1 = getRandomInt(1, 16)), void 0 == curves[a].c2Keep && (curves[a].c2 = getRandomInt(1, 16)), void 0 == curves[a].c0Keep && void 0 == curves[a].c1Keep && void 0 == curves[a].c2Keep && setCycles(a), curves[a].reset = !1;
    }
  });
  randomizeRadii();
}
function scaleToFit() {
  if (curveCount == ONE) {
    if (void 0 == curves[0].drawKeep && void 0 == curves[0].r1Keep && void 0 == curves[0].r3keep) {
      var a = 1;
      a = ET == curves[0].type || HT == curves[0].type ? 200 / (curves[0].r1 + curves[0].r2) : 200 / (curves[0].r1 + curves[0].r2 + curves[0].r3);
      curves[0].r1 *= a;
      curves[0].r2 *= a;
      curves[0].r3 *= a;
    }
  } else {
    if (void 0 == curves[0].drawKeep && void 0 == curves[0].r1Keep && void 0 == curves[0].r3keep && void 0 == curves[1].drawKeep && void 0 == curves[1].r1Keep && void 0 == curves[1].r3Keep) {
      var b = Array(2);
      [0, 1].forEach(function(a) {
        b[a] = ET == curves[a].type || HT == curves[a].type ? 200 / (curves[a].r1 + curves[a].r2) : 200 / (curves[a].r1 + curves[a].r2 + curves[a].r3);
      });
      b[0] > b[1] ? [0, 1].forEach(function(a) {
        curves[a].r1 *= b[1];
        curves[a].r2 *= b[1];
        curves[a].r3 *= b[1];
      }) : [0, 1].forEach(function(a) {
        curves[a].r1 *= b[0];
        curves[a].r2 *= b[0];
        curves[a].r3 *= b[0];
      });
    }
  }
}
function getCurve(a) {
  var b = rotationFactor * Math.random() * Math.PI, d = curves[a].r1, e = curves[a].r2, l = curves[a].r3, g = curves[a].c0, f = curves[a].c1, h = curves[a].c2;
  switch(curves[a].type) {
    case HT:
      a = f / g - 1;
      f = d * Math.cos(b) + e * Math.cos(a * b);
      h = d * Math.sin(b) - e * Math.sin(a * b);
      var k = "M" + f + " " + h;
      for (var c = .01 * g + b; c < 2 * Math.PI * g + b; c += .01 * g) {
        k += "L", f = d * Math.cos(c) + e * Math.cos(a * c), k += f + " ", h = d * Math.sin(c) - e * Math.sin(a * c), k += h;
      }
      break;
    case EHT:
      a = f / g - 1;
      var m = (h - f) / g + 1;
      f = d * Math.cos(b) + e * Math.cos(a * b) + l * Math.cos(m * b);
      h = d * Math.sin(b) - e * Math.sin(a * b) + l * Math.sin(m * b);
      k = "M" + f + " " + h;
      for (c = .01 * g + b; c < 2 * Math.PI * g + b; c += .01 * g) {
        k += "L", f = d * Math.cos(c) + e * Math.cos(a * c) + l * Math.cos(m * c), k += f + " ", h = d * Math.sin(c) - e * Math.sin(a * c) + l * Math.sin(m * c), k += h;
      }
      break;
    case HHT:
      a = f / g - 1;
      m = (h + f) / g - 1;
      f = d * Math.cos(b) + e * Math.cos(a * b) + l * Math.cos(m * b);
      h = d * Math.sin(b) - e * Math.sin(a * b) - l * Math.sin(m * b);
      k = "M" + f + " " + h;
      for (c = .01 * g + b; c < 2 * Math.PI * g + b; c += .01 * g) {
        k += "L", f = d * Math.cos(c) + e * Math.cos(a * c) + l * Math.cos(m * c), k += f + " ", h = d * Math.sin(c) - e * Math.sin(a * c) - l * Math.sin(m * c), k += h;
      }
      break;
    case EET:
      a = f / g + 1;
      m = (f + h) / g + 1;
      f = d * Math.cos(b) + e * Math.cos(a * b) + l * Math.cos(m * b);
      h = d * Math.sin(b) + e * Math.sin(a * b) + l * Math.sin(m * b);
      k = "M" + f + " " + h;
      for (c = .01 * g + b; c < 2 * Math.PI * g + b; c += .01 * g) {
        k += "L", f = d * Math.cos(c) + e * Math.cos(a * c) + l * Math.cos(m * c), k += f + " ", h = d * Math.sin(c) + e * Math.sin(a * c) + l * Math.sin(m * c), k += h;
      }
      break;
    case HET:
      a = f / g + 1;
      m = (h - f) / g - 1;
      f = d * Math.cos(b) + e * Math.cos(a * b) + l * Math.cos(m * b);
      h = d * Math.sin(b) + e * Math.sin(a * b) - l * Math.sin(m * b);
      k = "M" + f + " " + h;
      for (c = .01 * g + b; c < 2 * Math.PI * g + b; c += .01 * g) {
        k += "L", f = d * Math.cos(c) + e * Math.cos(a * c) + l * Math.cos(m * c), k += f + " ", h = d * Math.sin(c) + e * Math.sin(a * c) - l * Math.sin(m * c), k += h;
      }
      break;
    case ET:
      for (a = f / g + 1, f = d * Math.cos(b) + e * Math.cos(a * b), h = d * Math.sin(b) + e * Math.sin(a * b), k = "M" + f + " " + h, c = .01 * g + b; c < 2 * Math.PI * g + b; c += .01 * g) {
        k += "L", f = d * Math.cos(c) + e * Math.cos(a * c), k += f + " ", h = d * Math.sin(c) + e * Math.sin(a * c), k += h;
      }
  }
  return k + "z";
}
function start() {
  "animate" != transition && (a2.setAttribute("onend", "redraw()"), transition = "animate", doTransition());
}
function step() {
  a2.setAttribute("onend", "");
  "animate" != transition && (a2.endElement(), doTransition());
  transition = "step";
}
function stop() {
  a2.setAttribute("onend", "");
  transition = "step";
}
function setFill() {
  if ("none" != color) {
    if ("stop" == color) {
      acol.setAttribute("from", acol.getAttribute("to")), acol.setAttribute("to", "white"), path.style.setProperty("fill-opacity", "0", ""), acol.beginElement(), color = "none", document.getElementById("colorSel").value = "#FFFFFF";
    } else {
      if ("random" == color) {
        path.style.setProperty("fill-opacity", "1", "");
        acol.setAttribute("from", acol.getAttribute("to"));
        var a = randomColor(!1);
        acol.setAttribute("to", a);
        acol.beginElement();
        document.getElementById("colorSel").value = a;
      } else {
        "start" == color && (path.style.setProperty("fill-opacity", "1", ""), color = document.getElementById("colorSel").value, acol.setAttribute("from", color), acol.setAttribute("to", color), acol.beginElement());
      }
    }
  }
}
function get1Curve(a) {
  a && (0 == symmetry ? randomizeCurves() : void 0 == curves[0].c1Keep && void 0 == curves[0].c2Keep ? randomizeSym1Curve() : randomizeCurves(), scaleToFit());
  return getCurve(0);
}
function get2Curves(a) {
  a && (0 == symmetry ? randomizeCurves() : void 0 == curves[0].c1Keep && void 0 == curves[0].c2Keep && void 0 == curves[1].c1Keep && void 0 == curves[1].c2Keep ? randomizeSym2Curves() : randomizeCurves(), scaleToFit());
  return getCurve(0) + " " + getCurve(1);
}
function doTransition() {
  a2.setAttribute("from", a2.getAttribute("to"));
  a2.setAttribute("dur", getDuration(4));
  acol.setAttribute("dur", getDuration(4));
  curveCount == ONE ? a2.setAttribute("to", get1Curve(!0)) : a2.setAttribute("to", get2Curves(!0));
  report();
  setFill();
  a2.beginElement();
}
function redraw() {
  0 == pause ? doTransition() : setTimeout(doTransition, 1000 * pause);
}
function getDuration(a) {
  return a * durationFactor + "s";
}
function report() {
  for (var a = 0; a <= curveCount; a++) {
    document.getElementById("curveSel" + a).value = curves[a].type, document.getElementById("rad1-" + a).textContent = curves[a].r1.toFixed(1), document.getElementById("rad1Sel" + a).value = curves[a].r1.toFixed(1), document.getElementById("rad2-" + a).textContent = curves[a].r2.toFixed(1), document.getElementById("rad2Sel" + a).value = curves[a].r2.toFixed(1), document.getElementById("rad3Sel" + a).value = curves[a].r3.toFixed(1), document.getElementById("c0-" + a).textContent = curves[a].c0, document.getElementById("c0Sel" + 
    a).value = curves[a].c0, document.getElementById("c1-" + a).textContent = curves[a].c1, document.getElementById("c1Sel" + a).value = curves[a].c1, ET == curves[a].type || HT == curves[a].type ? (document.getElementById("rad3-" + a).textContent = "N/A", document.getElementById("c2-" + a).textContent = "N/A") : (document.getElementById("rad3-" + a).textContent = curves[a].r3.toFixed(1), document.getElementById("c2-" + a).textContent = curves[a].c2, document.getElementById("c2Sel" + a).value = curves[a].c2);
  }
}
function quickChange() {
  a2.setAttribute("dur", "1ms");
  a2.setAttribute("from", a2.getAttribute("to"));
  curveCount == ONE ? a2.setAttribute("to", get1Curve(!1)) : a2.setAttribute("to", get2Curves(!1));
  a2.beginElement();
}
function hideCurve2(a) {
  a = document.querySelector(".c2show");
  null != a && (a.className = "c2hide", requestAnimationFrame(hideCurve2));
}
function showCurve2(a) {
  a = document.querySelector(".c2hide");
  null != a && (a.className = "c2show", requestAnimationFrame(showCurve2));
}
function switchToTwo() {
  curveCount = TWO;
  document.getElementById("cdivcurv").style.height = "auto";
  showCurve2();
  document.getElementById("c2btn").textContent = "remove";
  a2.setAttribute("from", getZeroCurve() + " " + getZeroCurve());
  curves[1].reset = !0;
  a2.setAttribute("to", get2Curves(!1));
  "step" == transition ? a2.setAttribute("onend", "") : a2.setAttribute("onend", "redraw()");
  report();
  a2.beginElement();
}
function switchToOne() {
  curveCount = ONE;
  document.getElementById("cdivcurv").style.height = "auto";
  hideCurve2();
  document.getElementById("c2btn").textContent = "add";
  a2.setAttribute("from", getZeroCurve());
  a2.setAttribute("to", get1Curve(!1));
  "step" == transition ? a2.setAttribute("onend", "") : a2.setAttribute("onend", "redraw()");
  report();
  a2.beginElement();
}
function toZero() {
  a2.setAttribute("from", a2.getAttribute("to"));
  curveCount == ONE ? (a2.setAttribute("to", getZeroCurve()), a2.setAttribute("onend", "switchToTwo()")) : (a2.setAttribute("to", getZeroCurve() + " " + getZeroCurve()), a2.setAttribute("onend", "switchToOne()"));
  a2.setAttribute("dur", getDuration(1));
  a2.beginElement();
}
function switchCurveTwo() {
  "step" == transition ? toZero() : a2.setAttribute("onend", "toZero()");
}
function keepCurve(a, b) {
  curves[b].curveKeep = a.checked ? curves[b].type : void 0;
}
function changeCurve(a, b) {
  curves[b].type = a.value;
  ET == curves[b].type || HT == curves[b].type ? (document.getElementById("rad3-" + b).textContent = "N/A", document.getElementById("c2-" + b).textContent = "N/A") : (document.getElementById("rad3-" + b).textContent = curves[b].r3.toFixed(1), document.getElementById("c2-" + b).textContent = curves[b].c2, document.getElementById("c2Sel" + b).value = curves[b].c2);
  "animate" == transition ? (document.getElementById("kCurve" + b).checked = "checked", curves[b].curveKeep = curves[b].type) : quickChange();
}
function keepR1(a, b) {
  a.checked ? (document.getElementById("rad1Sel" + b).value = curves[b].r1.toFixed(0), curves[b].r1Keep = curves[b].r1) : curves[b].r1Keep = void 0;
}
function changeR1(a, b) {
  curves[b].r1 = parseFloat(a.value);
  document.getElementById("rad1-" + b).textContent = curves[b].r1.toFixed(1);
  "animate" == transition ? (document.getElementById("kR0-" + b).checked = "checked", curves[b].r1Keep = curves[b].r1) : quickChange();
}
function keepR2(a, b) {
  curves[b].drawKeep = a.checked ? curves[b].r2 : void 0;
}
function changeR2(a, b) {
  curves[b].r2 = parseFloat(a.value);
  document.getElementById("rad2-" + b).textContent = curves[b].r2.toFixed(1);
  "animate" == transition ? (document.getElementById("kR1-" + b).checked = "checked", curves[b].drawKeep = curves[b].r2) : quickChange();
}
function keepR3(a, b) {
  curves[b].r3Keep = a.checked ? curves[b].r3 : void 0;
}
function changeR3(a, b) {
  curves[b].r3 = parseFloat(a.value);
  ET != curves[b].type && HT != curves[b].type && (document.getElementById("rad3-" + b).textContent = curves[b].r3.toFixed(1));
  "animate" == transition ? (document.getElementById("kR3-" + b).checked = "checked", curves[b].r3Keep = curves[b].r3) : quickChange();
}
function keepC0(a, b) {
  curves[b].c0Keep = a.checked ? curves[b].c0 : void 0;
}
function changeC0(a, b) {
  curves[b].c0 = parseInt(a.value);
  document.getElementById("c0-" + b).textContent = curves[b].c0;
  "animate" == transition ? (document.getElementById("kC0-" + b).checked = "checked", curves[b].c0Keep = curves[b].c0) : quickChange();
}
function keepC1(a, b) {
  curves[b].c1Keep = a.checked ? curves[b].c1 : void 0;
}
function changeC1(a, b) {
  curves[b].c1 = parseInt(a.value);
  document.getElementById("c1-" + b).textContent = curves[b].c1;
  "animate" == transition ? (document.getElementById("kC1-" + b).checked = "checked", curves[b].c1Keep = curves[b].c1) : quickChange();
}
function keepC2(a, b) {
  curves[b].c2Keep = a.checked ? curves[b].c2 : void 0;
}
function changeC2(a, b) {
  curves[b].c2 = parseInt(a.value);
  ET != curves[b].type && HT != curves[b].type && (document.getElementById("c2-" + b).textContent = curves[b].c2);
  "animate" == transition ? (document.getElementById("kC2-" + b).checked = "checked", curves[b].c2Keep = curves[b].c2) : quickChange();
}
function changeSpeed(a) {
  durationFactor = 1 / Math.pow((parseInt(a.value) + 2) / 6, 2);
}
function changeSymmetry(a) {
  symmetry = parseInt(a.value);
  curves[0].reset = !0;
}
function changeRotation(a) {
  rotationFactor = a.value;
}
function changePause(a) {
  pause = a.value;
}
function changeDamp(a) {
  curveChangeRate = a.value;
}
function changeFill(a) {
  if (a.checked) {
    switch(a.id) {
      case "nofill":
        color = "stop";
        break;
      case "colfill":
        color = "start";
        break;
      default:
        color = "random";
    }
  }
}
function changeFillColor(a) {
  document.getElementById("colfill").checked = !0;
  color = "start";
}
function changeLineWidth(a) {
  path.style.setProperty("stroke-width", a.value, "");
}
function changeLineColor(a) {
  path.style.setProperty("stroke", a.value, "");
}
function changeBackground(a) {
  document.getElementById("asbox").style.setProperty("fill", a.value, "");
}
function setMenu(a, b) {
  b ? (a.dataset.state = "1", a.title = "hide") : (a.dataset.state = "0", a.title = "show");
  a.childNodes.forEach(function(a) {
    "SPAN" == a.tagName && (a.style.transform = b ? "rotate(90deg)" : "rotate(0deg)");
  });
}
function checkMenus() {
  var a = 0;
  document.querySelectorAll(".pmenu").forEach(function(b) {
    a += parseInt(b.dataset.state);
  });
  0 == a ? setMenu(document.getElementById("mainmenu"), !1) : 3 == a && setMenu(document.getElementById("mainmenu"), !0);
}
function menuAnimate(a, b) {
  b.start || (b.start = a);
  var d = a - b.start, e = d / 400;
  b.open ? (b.divstyle.height = Math.min(e * b.ht, b.ht) + "px", b.divstyle.width = Math.min(180 + e * (b.wd - 180), b.wd) + "px") : (b.divstyle.height = b.ht - Math.min(e * b.ht, b.ht) + "px", b.divstyle.width = b.wd - Math.min(180 * e, 180) + "px");
  400 > d && requestAnimationFrame(function(a) {
    menuAnimate(a, b);
  });
}
function togAll(a) {
  var b = document.querySelectorAll(".pmenu");
  "0" == a.dataset.state ? (b.forEach(function(a) {
    "0" == a.dataset.state && togMenu(a, !0);
  }), setMenu(a, !0)) : (b.forEach(function(a) {
    "1" == a.dataset.state && togMenu(a, !1);
  }), setMenu(a, !1));
}
function togMenu(a, b) {
  var d = document.getElementById("cdiv" + a.dataset.con), e = document.getElementById("props" + a.dataset.con), l = {start:null, divstyle:d.style, ht:e.offsetHeight, wd:e.offsetWidth};
  1 == arguments.length ? ("0" == a.dataset.state ? (l.open = !0, requestAnimationFrame(function(a) {
    menuAnimate(a, l);
  }), setMenu(a, !0)) : (l.open = !1, requestAnimationFrame(function(a) {
    menuAnimate(a, l);
  }), setMenu(a, !1)), checkMenus()) : (l.open = b, requestAnimationFrame(function(a) {
    menuAnimate(a, l);
  }), setMenu(a, b));
}
start();
-->
</script>
  </body>
</html>
